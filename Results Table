# Creating Final Dataset

import pandas as pd

# read the file and put it into the dataframe df
# header = 0 means the first line of the XL has the headers (as opposed to be a regular row)
# index_col = None means the first column is a regular data column as opposed to being an index column

df =  pd.read_excel('ExtractedData.xlsx', index_col=None, header=0) 

# go through the columns of the dataframe
# print the column name
# print the distinct values
for column in df:
    print(column)
    print(df[column].unique())
    
    # dictionary mapping for first column
di = {'Abalone':'Abalone',
       'African Grey Parrots':'Birds',
       'Amphibians':'Reptiles and Amphibians',
       'Animal Furs':'Animal Skins' ,
     'Animal Skin Boots':'Animal Skins',
       'Apes':'Apes',
       'Aquarium Fish':'Fish',
       'Armadillo':' Armadillos',
       'Arowana':'Fish',
     'Barbary Macaques':'Monkeys',
       'Bear Parts' : 'Bears',
       'Big Cat Pelts':'Big Cats',
       'Bird Nests':'Birds',
       'Birds':'Birds',
     'Caviar':'Caviar',
       'Cheetah Skins': 'Big Cats',
       'Chimpanzees':'Apes',
       'Cockatoos':'Birds',
       'Coral': 'Marine Invertebrates',
     'Crocodile Parts': 'Reptiles and Amphibians',
       'Deer':'Deer',
       'Deer Musk':'Deer',
       'Eels': 'Fish',
       'Elephant Ivory':'Ivory',
     'Exotic Pets':  'Live Animals and Pets' ,
       'Falcons':'Birds',
       'Fish':'Fish',
       'Geckos':'Reptiles and Amphibians',
       'Gorillas':'Apes',
       'Hippo Ivory':'Ivory',
     'Hornbill Beaks':'Birds',
       'Hummingbirds':'Birds',
       'Jaguars':'Big Cats',
       'Leopard Skin':'Big Cats',
       'Leopards':'Big Cats',
     'Lions and Lion Bones':'Big Cats',
       'Live Game': 'Live Animals and Pets',
       'Lizards':'Reptiles and Amphibians',
       'Macaws':'Birds',
       'Monkeys':'Monkeys',
     'Not Specified/ Wildlife In General': 'Not Specified/ Wildlife In General',
       'Octopi': 'Marine Invertebrates',
       'Palm Civet':'Civets',
     'Pangolin Scales':'Pangolins',
       'Pangolins':'Pangolins',
       'Parakeets':'Birds',
       'Parrots':'Birds',
       'Pipefish':'Fish',
     'Polar Bears':'Bears',
       'Reptile Skin Boots':'Reptiles and Amphibians',
       'Reptile Skins':'Reptiles and Amphibians',
       'Reptiles': 'Reptiles and Amphibians',
     'Rhino Horn':'Rhino Horn',
       'Rock Lobster': 'Marine Invertebrates',
       'Sea Cucumber': 'Marine Invertebrates',
       'Sea Shells': 'Marine Invertebrates',
       'Sea Turtles':'Reptiles and Amphibians',
     'Seahorse':'Fish',
       'Seahorses':'Fish',
       'Shahtoosh':'Antelope',
       'Shark Fins':'Fish',
       'Snails': 'Terrestrial Invertebrates',
       'Snake Galls':'Reptiles and Amphibians',
     'Snakes':'Reptiles and Amphibians',
       'Spiders':'Terrestrial Invertebrates',
       'Sturgeon Caviar':'Caviar',
     'Tigers and Tiger Parts':'Big Cats',
       'Tortoises':'Reptiles and Amphibians',
       'Totoaba Fish Bladders': 'Fish',
     'Tropical Fish':'Fish',
       'Turtles':'Reptiles and Amphibians',
       'Vicuñas':' Vicuñas',
       'Walrus Ivory':'Ivory',
      'Invertebrates (Terrestrial)': 'Terrestrial Invertebrates',
       'Whales':'Cetaceans'}

# dictionary mapping for 3rd column
d2 = {'Drug Trafficking': 'Drug Trafficking',
      'Mandrax Trafficking': 'Drug Trafficking',
      'Methamphetamine Trafficking': 'Drug Trafficking',
     'Bonded Labour': 'Trafficking in Persons and Migrant Smuggling',
      'Armed Robbery' : 'Theft and Organised Robbery',
      'Theft and Armed Robbery' : 'Theft and Organised Robbery',
      'Arms And Ammunition Trafficking': 'Arms, Weapons, Ammunition and Parts Trafficking',
     'ATM Bombing':'Other Serious and Organised Crime',
      'Counterfeit Goods Trafficking': 'Counterfeit Goods Trafficking (Inc. Electronics, Accessories, Clothing)',
      'Cycad Trafficking':'Contraband Trafficking (General)',
     'Diamond Trafficking': 'Illegal Mining and Trafficking in Minerals, Metals, and Gemstones',
      'Heroin Trafficking': 'Drug Trafficking',
      'Human Trafficking': 'Trafficking in Persons and Migrant Smuggling',
     'Illegal Gambling': 'Racketeering (Incl. Banditry, Extortion, Kidnapping for Ransom, Illegal Gambling, and Loansharking)',
      'Migrant Smuggling': 'Trafficking in Persons and Migrant Smuggling',
      'Narcotics Trafficking':'Drug Trafficking',
     'Organised Crime Group': 'Organised Crime Group Involvement',
     'Prescription medicine and pharmaceutical products':'Drug Trafficking',
     'Sex Trafficking, Sex Slavery, and Prostitution': 'Trafficking in Persons and Migrant Smuggling',
     'Vehicle Theft and Illegal Trade': 'Theft and Organised Robbery',
    'Cash Smuggling': 'Bulk Cash Smuggling and Counterfeit Currencies',
     'Counterfeit, forged, and fraudulent documentation'
     'Banditry, Racketeering, Extortion, and Kidnapping': 'Racketeering (incl. Banditry, Extortion, Kidnapping for Ransom, Illegal Gambling, and Loansharking)',
     'Corruption (Petty and Grand)'
     'Criminal Violence (Incl. Homicide, Torture, Rape, Assault)'
      'Fraud':'Fraud (General)',
     'Loan Sharking': 'Racketeering (Incl. Banditry, Extortion, Kidnapping for Ransom, Illegal Gambling, and Loansharking)',
      'Money Laundering': 'Money Laundering, Tax Evasion, and other Illicit Financial Flows',
      'Tax Fraud and Evasion': 'Money Laundering, Tax Evasion, and other Illicit Financial Flows',
     'Cigarette Trafficking': 'Contraband Trafficking (General)',
      'Trafficking In Clothes And Household Goods': 'Counterfeit Goods Trafficking (Inc. Electronics, Accessories, Clothing)',
     'Charcoal Trafficking': 'Contraband Trafficking (General)',
      'Electronic Goods Trafficking': 'Counterfeit Goods Trafficking (Inc. Electronics, Accessories, Clothing)',
      'Timber Trafficking' : 'Illegal Logging and Timber Trafficking',
      'Militias And Insurgencies':'Non-State Armed Groups (Incl. Terrorist, Militias, and Insurgents)',
     'Food and Agricultural Goods Trafficking'
     'Semi-Precious Gemstones Trafficking': 'Illegal Mining and Trafficking in Minerals, Metals, and Gemstones',
     'Trafficking In Clothes And Household Goods' : 'Counterfeit Goods Trafficking (Inc. Electronics, Accessories, Clothing)',
      'Illegal Logging': 'Illegal Logging and Timber Trafficking',
       'Illegal Mining': 'Illegal Mining and Trafficking in Minerals, Metals, and Gemstones',
      'Cocaine Trafficking':'Drug Trafficking',
      'Marijuana Trafficking':'Drug Trafficking',
     'Shell Companies': 'Money Laundering, Tax Evasion, and other Illicit Financial Flows',
      'Front Companies': 'Money Laundering, Tax Evasion, and other Illicit Financial Flows',
     'Counterfeit Brand Accessories (E.G. Watches, Handbags And Wallets) Trafficking': 'Counterfeit Goods Trafficking (Inc. Electronics, Accessories, Clothing)',
     'Opium Trafficking':'Drug Trafficking',
      'Terrorism': 'Non-State Armed Groups (Incl. Terrorist, Militias, and Insurgents)',
      'Weapons Trafficking': 'Arms, Weapons, Ammunition and Parts Trafficking',
      'Cash Trafficking': 'Bulk Cash Smuggling and Counterfeit Currencies',
     'Gold Trafficking': 'Illegal Mining and Trafficking in Minerals, Metals, and Gemstones',
      'Cattle Rustling': 'Theft and Organised Robbery',
      'Counterfeit Currency' : 'Bulk Cash Smuggling and Counterfeit Currencies',
     'Explosives Trafficking': 'Arms, Weapons, Ammunition and Parts Trafficking',
      'Antiques Trafficking' : 'Contraband Trafficking (General)',
      'Coltan Trafficking':'Illegal Mining and Trafficking in Minerals, Metals, and Gemstones',
     'Fuel Trafficking': 'Contraband Trafficking (General)',
      'Hashish Trafficking':'Drug Trafficking',
      'Mineral Trafficking': 'Illegal Mining and Trafficking in Minerals, Metals, and Gemstones',
     'Opioid (Tramadol) Trafficking':'Drug Trafficking',
      'Slavery' : 'Trafficking in Persons and Migrant Smuggling',
      'Theft': 'Theft and Organised Robbery',
      'Uranium Trafficking': 'Illegal Mining and Trafficking in Minerals, Metals, and Gemstones',
     'Child Slavery (Incl. Forced Labour and Slavery)': 'Trafficking in Persons and Migrant Smuggling',
      'Opioid Trafficking':'Drug Trafficking',
     'Tantalum Trafficking': 'Illegal Mining and Trafficking in Minerals, Metals, and Gemstones',
      'Tungsten Trafficking': 'Illegal Mining and Trafficking in Minerals, Metals, and Gemstones',
      'Violent Conflict':  'Criminal Violence (Incl. Homicide, Torture, Rape, Assault)',
     'Forced Labor': 'Trafficking in Persons and Migrant Smuggling',
      'Cassiterite Trafficking': 'Illegal Mining and Trafficking in Minerals, Metals, and Gemstones',
      'Cobalt Trafficking': 'Illegal Mining and Trafficking in Minerals, Metals, and Gemstones',
     'Illegal Coltan Mining': 'Illegal Mining and Trafficking in Minerals, Metals, and Gemstones',
      'Wolframite Trafficking': 'Illegal Mining and Trafficking in Minerals, Metals, and Gemstones',
     'Contraband Trafficking (General)': 'Contraband Trafficking (General)',
      'Gem Trafficking': 'Illegal Mining and Trafficking in Minerals, Metals, and Gemstones',
     'Alcohol Trafficking': 'Contraband Trafficking (General)',
      'Diamonds Trafficking': 'Illegal Mining and Trafficking in Minerals, Metals, and Gemstones',
      'Gang and Mafia Activities': 'Organised Crime Group Involvement',
     'Intellectual Property Rights Theft' : 'Other Serious and Organised Crime',
      'Jade Trafficking': 'Illegal Mining and Trafficking in Minerals, Metals, and Gemstones',
     'Nonferrous Metals Trafficking': 'Illegal Mining and Trafficking in Minerals, Metals, and Gemstones',
      'Arms and Ammunition Trafficking': 'Arms, Weapons, Ammunition and Parts Trafficking',
     'Precious Stones Trafficking': 'Illegal Mining and Trafficking in Minerals, Metals, and Gemstones',
     'Snythetic Drugs Trafficking':'Drug Trafficking',
      'Tobacco Trafficking': 'Contraband Trafficking (General)',
     'Synthetic Drug Precursors' :'Drug Trafficking',
      'Criminal Damage': 'Other Serious and Organised Crime',
      'Cybercrime': 'Other Serious and Organised Crime',
      'Embezzlement': ' Money Laundering, Tax Evasion, and other Illicit Financial Flows',
     'Illicit Financial Flows': 'Money Laundering, Tax Evasion, and other Illicit Financial Flows',
      'Organised Robbery': 'Theft and Organised Robbery',
     'Malicious Damage To Property' :'Other Serious and Organised Crime',
      'Piracy':'Other Serious and Organised Crime'}

# create another dataframe df2 with the first column mappings changed
df2=df.replace({"Taxa/ Product": di})

# create another dataframe df2 with the first column mappings changed
df3=df2.replace({"Other Crime": d2})

# group by all 3 columns get the counts (how many rows) and the sum of values 
df3.groupby(['Taxa/ Product', 'Convergence Type', 'Other Crime']).agg({'Count': ['sum', 'count']})

# export the dataframe to an excel file 
df3.to_excel("/Users/Dataset_Final.xlsx")  
